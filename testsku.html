
  <!--下面是模板标签，不可删除--> 
  
  <input type="hidden" id="good_id" value="<?php echo $_GET['good_id'] ?>">
  <main class="wrapper"> 
   <div class="container"> 
    <section class="crumbs clearfix"> 
     <a data-mtype="store_de_mbx_1" href="{:U('home/index/index')}">首页</a>&nbsp;&gt;&nbsp; 
     <a class="ellipsis crumbs-title"><?php echo $goodRes[0]['good_name'] ?></a> 
    </section> 
    <section class="row"> 
     <div class="preview" id="preview"> 
      <div class="preview-booth"> 
       <a href="javascript:;" id="J_imgBooth">
        <!-- 默认显示第0张 -->
        <img src="__ROOT__/<?php echo $gooditemsl[0]['good_imgs'][0]  ?>" height="660" width="660" alt="" id="bigimages" /> </a> 
      </div> 
      <ul class="preview-thumb clearfix" id="J_previewThumb">
      <?php  
        foreach ($gooditemsl[0]['good_imgs'] as $key => $value) {
          ?>
            <li class="">
              <a data-mtype="store_de_tp_11" href="javascript:void(0)">
                <img src="__ROOT__/<?php echo $value ?>" width="110" height="110" />
              </a>
            </li>
          <?php
        }
      ?>
      </ul> 
     </div>
     <input type="hidden" value="<?php echo $_SESSION['uid'] ?>" id="setsession">
     <div class="property" id="property"> 
      <div class="property-hd"> 
       <h1><?php echo $goodRes[0]['good_name'] ?></h1> 
       <p class="mod-info"><?php echo $goodRes[0]['good_desc'] ?></p> 
       <p class="mod-price"> <em class="vm-yen">&yen;</em> <span class="vm-price" id="J_price"><?php  echo $gooditemsl[0]['good_price'] ?></span> </p> 
      </div> 
    
      <span class="selfadd" id="selfadd">
      <?php
        foreach ($skuresArr as $key => $value) {
            ?>
              <dl class="property-sale"> 
               <dt class="vm-metatit">
                <?php echo $key ?>
               </dt> 
               <dd> 
                <ul data-property="<?php echo $key ?>" class="clearfix">
                  <?php
                    foreach ($value as $k => $v) {
                        ?>
                          <li data-value="14:18238"

                           attrid="<?php echo $v['good_attr_id'] ?>" title="<?php echo $v['good_attr_value'] ?>" 
                           class='publicuse  <?php if(in_array($v['good_attr_id'], $gooditemsl[0]['attr_combine'])){ echo 'selected'; } 
                            if(!in_array($v['good_attr_id'],$have)){ echo 'disabled' ;}
                           ?> '
                          > 
                            <a data-mtype="store_de_sp_1_1" href="javascript:void(0)"> <span><?php echo $v['good_attr_value'] ?></span> 
                            </a> 
                           </li>
                        <?php
                      }  
                  ?>
                </ul> 
               </dd> 
              </dl>
            <?php
          }
      ?>
    </span>
      <dl class="property-quantity"> 
       <dt class="vm-metatit">
        数量:
       </dt> 
       <dd class="clearfix"> 
        <div class="property-quantity-control"> 
         <a title="减少" href="javascript:;" class="vm-minus">-</a> 
         <input type="text" value="1" id="J_quantity" data-max="<?php echo $gooditemsl[0]['good_stock'] ?>" /> 
         <a title="增加" href="javascript:;" class="vm-plus">+</a> 
        </div> 
        <span id="J_Stock" class="vm-count">（最大库存量: <span id="stockself"><?php echo $gooditemsl[0]['good_stock'] ?></span> ）</span> 
       </dd> 
      </dl> 
      <dl class="property-service"> 
       <dt class="vm-metatit">
        服务：
       </dt> 
       <dd class="clearfix"> 
        <span><i class="icons icon-invoice"></i>电子发票</span> 
       </dd> 
      </dl> 
      <dl class="property-info" id="propertyInfo"> 
       <!-- <dt class="mod-title">
         您已选择以下商品: 
       </dt>  -->
       <!-- <dd class="mod-summary"> 
        <p id="J_summaryMain">魅蓝3 移动定制版 白色 16GB&nbsp;&nbsp;￥599</p> 
        <p id="J_summaryPackageName"></p> 
        <p id="J_sumaryPackageItemNames"></p> 
        <div id="J_delivery" class="mod-site clearfix" style="display:none;"> 
         <label class="site-label">配送至</label> 
         <div id="site-selector" class="site-selector"> 
          <div class="text"> 
           <div></div> 
           <b></b>
          </div> 
          <div class="content"> 
          </div> 
         </div> 
         <span class="site-status" id="J_siteStatus"> </span> 
        </div> 
        <p><span id="J_installmentInfo"></span>本商品由 魅族 负责发货，并由 魅族 提供售后服务</p> 
       </dd> --> 
       <dd class="mod-total">
         总计:
        <em class="vm-price" id="J_totalPrice">￥<?php echo $gooditemsl[0]['good_price'] ?></em> 
       </dd> 
      </dl> 
      <dl class="property-buy" id="J_BuyOrDiy"> 
       <dt class="vm-message" id="J_message"> 
       </dt>

       
        <dd>
          <a id="J_btnCar" class="btn btn-primary btn-lg" data-mtype="store_de_buy" href="javascript:void(0);" style="color: rgb(255, 255, 255);background-color: rgb(94, 185, 94);border-color: rgb(94, 185, 94);">加入购物车</a>
          <span class="vm-service ml10" id="J_panicBuyingWrap"></span>

           <a id="J_btnBuy" class="btn btn-primary btn-lg" data-mtype="store_de_buy" href="javascript:void(0);">立即购买</a>
          <span class="vm-service ml10" id="J_panicBuyingWrap"></span>


        </dd>
      </dl> 

     </div> 
    </section> 
   </div> 
  




   <section class="row detail" id="detail"> 
    <div style="height:62px;"> 
     <div class="detail-tab" id="detailTabFixed"> 
      <div class="fixed-container"> 
       <ul class="clearfix"> 
        <li class="current switchClick"> <a data-mtype="store_de_xq_1" href="javascript:void(0)">商品详情</a> </li> 
        <li class="switchClick"> <a data-mtype="store_de_xq_2" href="javascript:void(0)">规格参数</a> </li> 
       <!--  <li class="switchClick"> <a data-mtype="store_de_xq_3" href="javascript:void(0)">常见问题</a> </li>  -->
       </ul> 
       <div class="shortcut trans"> 
        <div class="mod-buy"> 
         <a href="javascript:void(0);" id="J_btnBuyShortcut" class="btn btn-primary btn-lg"><i></i>现在购买</a> 
        </div> 
        <div class="mod-total">
          总计:
         <em class="vm-price" id="J_totalPriceShortcut">￥599.00</em> 
        </div> 
        <div class="mod-title">
          魅蓝3 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="detail-content container"> 
     <div class="introduce" id="introduce" style="display:block;text-align:center"> 
        <?php echo $goodRes[0]['good_detail'] ?>
     </div> 
     <div class="standard" id="standard" > 
      <table class="standard-table"> 
       <tbody>
        <?php  
          foreach ($normNameRes as $key => $value) {
            ?>
               <tr> 
                 <th style="text-align:center;"> <?php echo $value ?> </th> 
                 <td> <?php echo $goodRes[0]['canshu'][$key] ?> </td> 
              </tr> 
            <?php
          }
        ?> 
       </tbody> 
      </table> 
     </div> 
     <!-- <div class="question" id="question"> 
      <div class="question-list"> 
       <h2>热门回答</h2> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 的全网通公开版、电信版，移动定制版，联通版的区别？ 
        </dt> 
        <dd class="vm-answer">
          全网通（公开版、电信版）支持的运营商网络制式有：移动 4G TD-LTE、联通/电信 4G TD/FDD-LTE、移动 3G TD-SCDMA、联通 3G WCDMA、电信 3G EVDO、移动/联通 2G GSM、电信 2G CDMA； 联通版/移动定制版支持的运营商网络制式有：移动 4G TD-LTE、联通 4G TD/FDD-LTE、移动 3G TD-SCDMA、联通 3G WCDMA、移动/联通 2G GSM。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 的屏幕尺寸是多大？有哪几种颜色？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 配备一块 5 英寸 1280x720 分辨率屏幕，采用先进的 IPS 显示技术;此外，魅蓝 3 使用 GFF 全贴合技术，减少显示面板与 2.5D 玻璃板间折射反光，让屏幕看起来更加圆润通透. 魅蓝 3 在此前多彩的基础上，更新增了备受期待的金色。同时，精心调整的粉色更显水嫩，如马卡龙的香甜温馨。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 是否支持指纹识别？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 不支持指纹识别。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 屏幕采用什么工艺？ 
        </dt> 
        <dd class="vm-answer">
          2.5D 玻璃前面板不仅成就了魅蓝 3 视觉上的晶莹剔透，更收获了令人惊讶的顺滑手感。我们针对性地重新设计机身弧度，使其与 2.5D 玻璃圆满契合。精确至毫米级的内部重构，又凝练出魅蓝 3 令人讶异的纤巧机身。更为先进的镀膜和喷涂工艺，赋予了魅蓝 3 丝滑的细腻触感。如此，才可成就魅蓝 3 手感的全方位蜕变。一入手，便爱不释手。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 是否支持 TF 扩展？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 支持 TF 扩展，最高支持 128GB。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 支持的网络有哪些？是否具备 VoLTE 语音通话技术？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 全面支持国内移动、联通、电信三大运营商网络，两个卡槽都支持 4G 极速上网，不再区分主副卡。同时 VoLTE 也已来到魅蓝 3，通话接通缩短 90%，视频通话质量更是清晰十倍 ；另外，魅蓝 3 还新增高铁模式，可以有效降低高速运动过程中信号失真，修正网络卡顿和掉线，让你在高速行驶的高铁内也能稳定地上网，让旅途不再无聊。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 的 CPU 是用什么处理器？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 采用八核 64 位处理器，使用高端 HPM 工艺，主频最高可达 1.5GHz，性能是上一代的整整 1.6 倍，同时，大小核的搭配让其更加节能。而 Mali-T860 GPU，图像处理能力较上一代提升 50%，配合 2GB/3GB 运行内存，eMMc5.0 极速闪存，魅蓝 3 绝不仅限于满足日常应用，即使是面对大型 3D 游戏也能轻快处理，流畅运行。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 的运行内存是多少？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 16G 版本搭配 2G RAM，32G 版本搭配 3G RAM。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 后置摄像头是多少像素？ 
        </dt> 
        <dd class="vm-answer">
          一款出色的相机，能够为你留下人生追忆的瞬间。魅蓝 3 正是为此而来。1300W 后置摄像头，是不放过任何细节的慧眼；快至 0.2s 的相位对焦 ，能抓住转瞬即逝的刹那；而遇到暗光时，双色温闪光灯在及时补充光线的同时，又能保证拍出的照片色彩准确。 
        </dd> 
       </dl> 
       <dl class="mod-item"> 
        <dt class="vm-question">
          魅蓝 3 的电池规格？ 
        </dt> 
        <dd class="vm-answer">
          魅蓝 3 CPU 采用独特的 CorePilot™2.0 异构计算技术，可以根据应用场景，智能协调 8 核芯负载，高效利用性能的同时，让每一分电量都物尽所值。此外，魅蓝 3 搭载的 Flyme 5.1 power by YunOS 专门针对功耗进行了深度优化，2870mAh 大容量电池更是为虎添翼，赋予了魅蓝 3 非凡的续航表现，让你一整天使用足够有安全感。 
        </dd> 
       </dl> 
      </div> 
     </div> --> 
    </div> 
   </section> 
  </main> 
  <input type="hidden" name="curr_microtime" id="curr_microtime" value="1469759228898" /> 
  <!-- <div class="site-footer"> 
   <div class="mzcontainer"> 
    <div class="site-footer-service"> 
     <ul class="clearfix"> 
      <li class="service-item"> <span class="service-icon service-icon-seven"></span> <p class="service-desc"> <span class="service-desc-bold">7天</span> <span class="service-desc-normal">无理由退货</span> </p> </li> 
      <li class="service-split-line"> <span></span> </li> 
      <li class="service-item"> <span class="service-icon service-icon-fifty"></span> <p class="service-desc"> <span class="service-desc-bold">15天</span> <span class="service-desc-normal">换货保障</span> </p> </li> 
      <li class="service-split-line"> <span></span> </li> 
      <li class="service-item"> <span class="service-icon service-icon-one"></span> <p class="service-desc"> <span class="service-desc-bold">1年</span> <span class="service-desc-normal">免费保修</span> </p> </li> 
      <li class="service-split-line"> <span></span> </li> 
      <li class="service-item"> <span class="service-icon service-icon-speed"></span> <p class="service-desc"> <span class="service-desc-bold">百城</span> <span class="service-desc-normal">速达</span> </p> </li> 
      <li class="service-split-line"> <span></span> </li> 
      <li class="service-item"> <span class="service-icon service-icon-by"></span> <p class="service-desc"> <span class="service-desc-bold">全场</span> <span class="service-desc-normal">包邮</span> </p> </li> 
      <li class="service-split-line"> <span></span> </li> 
      <li class="service-item"> <span class="service-icon service-icon-map"></span> <p class="service-desc"> <span class="service-desc-bold">2000多家</span> <span class="service-desc-normal">专卖店</span> </p> </li> 
     </ul> 
    </div> 
    <div class="site-footer-navs clearfix"> 
     <div class="footer-nav-item"> 
      <h4 class="footer-nav-title">帮助说明</h4> 
      <ul> 
       <li><a href="http://store.meizu.com/explain/payment_help.html" target="_blank">支付方式</a></li> 
       <li><a href="http://store.meizu.com/explain/deliverynote.html" target="_blank">配送说明</a></li> 
       <li><a href="http://store.meizu.com/explain/warranty_services.html" target="_blank">售后服务</a></li> 
       <li><a href="http://store.meizu.com/explain/payment_helps.html" target="_blank">付款帮助</a></li> 
      </ul> 
     </div> 
     <div class="footer-nav-item"> 
      <h4 class="footer-nav-title">Flyme</h4> 
      <ul> 
       <li><a target="_blank" href="https://open.flyme.cn/">开放平台</a></li> 
       <li><a target="_blank" href="http://www.flyme.cn/firmware.jsp">固件下载</a></li> 
       <li><a target="_blank" href="http://app.flyme.cn/">软件商店</a></li> 
       <li><a target="_blank" href="http://finder.flyme.cn/">查找手机</a></li> 
      </ul> 
     </div> 
     <div class="footer-nav-item"> 
      <h4 class="footer-nav-title">关于我们</h4> 
      <ul> 
       <li><a target="_blank" href="http://www.meizu.com/about.html">关于魅族</a></li> 
       <li><a target="_blank" href="http://hr.meizu.com/">加入我们</a></li> 
       <li><a target="_blank" href="http://www.meizu.com/contact.html">联系我们</a></li> 
       <li><a target="_blank" href="http://www.meizu.com/legalStatement.html">法律声明</a></li> 
      </ul> 
     </div> 
     <div class="footer-nav-item"> 
      <h4 class="footer-nav-title">关注我们</h4> 
      <ul> 
       <li><a target="_blank" href="http://weibo.com/meizumobile">新浪微博</a></li> 
       <li><a target="_blank" href="http://t.qq.com/meizu_tech">腾讯微博</a></li> 
       <li><a target="_blank" href="http://user.qzone.qq.com/2762957059">QQ空间</a></li> 
       <li> <a class="meizu-footer-wechat"> 官方微信 <img src="./good_detail_files/weixin.png" alt="微信二维码" /> </a> </li> 
      </ul> 
     </div> 
     <div class="footer-nav-custom"> 
      <h4 class="nav-custom-title">24小时全国服务热线</h4> 
      <a href="tel:400-788-3333"><h3 class="nav-custom-number">400-788-3333</h3></a> 
      <a class="nav-custom-btn" href="javascript:void(0);" onclick="window.open('http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&amp;configID=4&amp;enterurl='+ encodeURIComponent(document.URL) + '&amp;pagereferrer=' + encodeURIComponent(document.referrer) + '&amp;info=&amp;k=1', '_blank','height=775,width=1200,fullscreen=3,top=100,left=100,status=yes,toolbar=no,menubar=no,resizable=no,scrollbars=no,location=no,titlebar=no,fullscreen=no');"> <img src="./good_detail_files/20x21xiaoshi.png" width="20" height="21" /> 24小时在线客服 </a> 
     </div> 
    </div> 
    <div class="site-footer-end"> 
     <p> &copy;2016 Meizu Telecom Equipment Co., Ltd. All rights reserved. <a target="_blank" href="http://www.miitbeian.gov.cn/" hidefocus="true">备案号：粤ICP备13003602号-2</a> <a target="_blank" href="http://www2.res.meizu.com/zh_cn/images/common/icp2.jpg" hidefocus="true">经营许可证编号：粤B2-20130198</a> <a target="_blank" href="http://www2.res.meizu.com/zh_cn/images/common/com_licence.jpg" hidefocus="true">营业执照</a> <a target="_blank" rel="nofollow" href="http://210.76.65.188/" hidefocus="true"> <img src="./good_detail_files/footer-copy-1.png" /> </a> <a target="_blank" rel="nofollow" href="http://210.76.65.188/webrecord/innernet/Welcome.jsp?bano=4404013010531" hidefocus="true"> <img src="./good_detail_files/footer-copy-2.png" /> </a> <a target="_blank" rel="nofollow" href="https://credit.szfw.org/CX20151204012550820380.html" hidefocus="true"> <img src="./good_detail_files/trust-icon.png" /> </a> </p> 
    </div> 
   </div> 
  </div>
  <div class="site-gotop" id="siteGotop">
   <a class="gotop-suggest" title="建议反馈" href="http://detail.meizu.com/member/suggest/index" target="_blank"></a>
   <div class="gotop-arrow" title="回到顶部"></div>
  </div>
  </body>
</html>  -->
  <script charset="utf-8" src="__PUBLIC__/Home/js/site-lib.js"></script> 
  <script type="text/javascript" src="__PUBLIC__/Home/js/site-base.js"></script> 
  <script>var $=require("common:lib/jquery/jquery-1.11.3");require("common:lib/jquery/jquery-migrate-1.2.1"),window.$=$,window.jQuery=$,window.jquery=$,$(function(){require("common:widgets/site-topbar/topbar"),require("common:widgets/site-header/header")});</script> 
  <!-- 
  <script type="text/javascript" src="__PUBLIC__/Home/js/pkg-detail-85e3f9a.js"></script> 
   -->

  <script type="text/javascript">
    $(document).ready(function() {
      var licount = $('.property-sale').length; //获取到总数
      //页面加载的时候为第一个li加一个current的class
      $('#J_previewThumb').children('li').eq(0).addClass('current');

      //图片切换
      $('#J_previewThumb').children('li').click(function(event) {
        $(this).addClass('current').siblings().removeClass('current');
        var src = $(this).children().find('img').attr('src');
        $('#bigimages').attr('src', src);
      });

      $(document).on('click', '#J_previewThumb li', function(event) {
         $(this).addClass('current').siblings().removeClass('current');
         var src = $(this).children().find('img').attr('src');
         $('#bigimages').attr('src', src);
      });

      //当点击li的时候
      // $(document).on('click', '.publicuse', function(event) {

      //   if($(this).hasClass('disabled')){
      //     return false;
      //   }

      //   //如果点击的是自己,那么就去除自己的selected样式
      //   if($(this).hasClass('selected')){
      //     $(this).removeClass('selected');
      //   // 否则就是点击的项
      //   }else{
      //     $(this).addClass('selected').siblings().removeClass('selected');
      //   }
        
      //   //循环得到有class为selected sku组合其中的值。
      //   var skuStr = '';
      //   $.each($('.selected'), function(index, val) {
      //     skuStr = skuStr  + $(this).attr('attrid') + ',';
      //   });
        
      //   //如果没有点就不走异步.
      //   if(skuStr == ''){
      //     return false;
      //   }
      //   var gid = $('#good_id').val();
      //    $.ajax({
      //       url: '{:U("home/shopdetail/checksku")}',
      //       type: 'POST',
      //       dataType: 'json',
      //       data: {sku: skuStr,good_id : gid},
      //       success:function(data){
      //         if(data.error == 0){
      //           $('#selfadd').html(data.strMsg);

      //           //如果选的sku是完整的就有返回价格
      //           if(data.good_price){
      //             $('#J_price').html(data.good_price);
      //             $('#J_totalPrice').html('￥'+data.good_price);
      //           }
      //           //如果不是完整的就没有返回价格
      //           if(data.stock){
      //             $('#J_quantity').val(1);
      //             $('#J_quantity').attr('data-max', data.stock);
      //             $('#stockself').html(data.stock);
      //           }
      //         }
      //       }
      //     })
      // });

      
      //点击商品详情 和 规格参数 切换的
      $(document).on('click', '.switchClick', function(event) {
        $(this).addClass('current').siblings().removeClass('current');
        $('.detail-content').children('div').siblings().css('display', 'none');
        $('.detail-content').children('div').eq($(this).index()).css('display', 'block');
      });

      //当文本框keyup的时候 还原默认值1
      // var stock = $('#J_quantity').val();
      $(document).on('blur', '#J_quantity', function(event) {
        // $(this).val(1);
        if($(this).val() < 0 || !/^[0-9]*$/.test($(this).val())){
            $(this).val(1);
        }

        var stock = $('#J_quantity').attr('data-max');
        if($(this).val() > parseInt(stock)){
          $('#J_quantity').val(stock);
        }
        var price = $('#J_price').html();
        var allprice = parseInt(price) * parseInt($(this).val());
        // alert(price);
        $('#J_totalPrice').html('￥'+allprice);
        // alert(stock);
      });

      // 点击+号
      $(document).on('click', '.vm-plus', function(event) {
        var num = $('#J_quantity').val();
        $('#J_quantity').val(parseInt(num) + 1);
        var selectnum = $('#J_quantity').val();
        var stock = $('#J_quantity').attr('data-max');
        if( parseInt(selectnum)  > parseInt(stock)){
          $('#J_quantity').val(stock);
        }
        var price = $('#J_price').html();
        var allprice = parseInt(price) * parseInt($('#J_quantity').val());
        // alert(price);
        $('#J_totalPrice').html('￥'+allprice);
      });


       // 点击-号
      $(document).on('click', '.vm-minus', function(event) {

        var num = $('#J_quantity').val();
        $('#J_quantity').val(parseInt(num) - 1);
        var selectnum = $('#J_quantity').val();
        if( parseInt(selectnum) < 1 ){
          $('#J_quantity').val(1);
        }
        var price = $('#J_price').html();
        var allprice = parseInt(price) * parseInt($('#J_quantity').val());
        // alert(price);
        $('#J_totalPrice').html('￥'+allprice);
      });

      //立即购买
      $(document).on('click', '#J_btnBuy', function(event) {
        var good_id = $('#good_id').val();
         //循环得到有class为selected sku组合其中的值。
        var skuStr = '';                            //获得sku的组合
        $.each($('.selected'), function(index, val) {
          skuStr = skuStr  + $(this).attr('val') + ',';
        });
        alert(skuStr);
        var skuCount = $('.property-sale').length;  //组合应有的数量
        var skuStrArr = new Array;
        skuStrArr = skuStr.split(",");    //将东西切成数组 用来做判断

        if(skuCount != (skuStrArr.length - 1)){
          alert('请选择完整的信息先');
        }else{
          //提交商品的数量
          var BuyNum = $('#J_quantity').val();
          $.ajax({
            url: '{:U("home/shopdetail/checkstock")}', //检查库存
            type: 'POST',
            dataType: 'json',
            data: {good_id: good_id,combine:skuStr,good_num:BuyNum},
            success:function(data){
              if(data.error == 0){
                // location.href = "{:U('home/order/')}"
                // location.href = 'http://<?php echo $_SERVER["HTTP_HOST"] ?>/__MODULE__/order/confirm/good_id/'+data.good_id+'/good_listid/'+data.good_listid+'/good_num/'+data.good_num+'';
                location.href = '{:U("home/order/confirm")}';
              }else{
                alert(data.msg);
              }
            },
            error:function(){ 
              alert('网络错误');
            }
          })
          
        }
      });
    



    //点击加入购物车
    $(document).on('click', '#J_btnCar', function(event) {
        if($('#setsession').val() == ''){
          if(confirm('请先登录,确定跳转到登录界面')){
            location.href='{:U("home/login/index")}';
            return false;
          }else{
            return false;
          }
          
        }
        var good_id = $('#good_id').val();
         //循环得到有class为selected sku组合其中的值。
        var skuStr = '';                            //获得sku的组合
        $.each($('.selected'), function(index, val) {
          skuStr = skuStr  + $(this).attr('attrid') + ',';
        });
        var skuCount = $('.property-sale').length;  //组合应有的数量
        var skuStrArr = new Array;
        skuStrArr = skuStr.split(",");    //将东西切成数组 用来做判断

        if(skuCount != (skuStrArr.length - 1)){
          alert('请选择完整的信息先');
        }else{
          //提交商品的数量
          var BuyNum = $('#J_quantity').val();
          $.ajax({
            url: '{:U("home/car/entercar")}', //检查库存
            type: 'POST',
            dataType: 'json',
            data: {good_id: good_id,combine:skuStr,good_num:BuyNum},
            success:function(data){
              if(data.error == 0){
                if(confirm('增加成功,是否跳转到购物车页面?')){
                  location.href="{:U('home/car/index')}";
                }else{
                  return false;
                }
              }else{
                alert(data.msg);
              }
            },
            error:function(){ 
              // alert('网络错误');
            }
          })
        }
        return false;
    });
    

    });
  </script>
  <div class="abc" id="price">gggg</div>
    <style type="text/css">
    .sel{

    }
    /*
  ul,li{ padding:0px; margin:0px;}    
  #panel{ width:500px; margin:30px auto;}


  .goods_attr{ overflow:hidden;}
  .goods_attr .label {font: 12px/30px '宋体';color: #777;width: 50px;;padding-right: 10px;float: left; display:block;}
  .goods_attr ul {float:left;width:300px;}

  .goods_attr li{color:#333;overflow:hidden;position:relative;float:left;text-align:center; vertical-align:middle; border:1px solid #999;text-indent:0; cursor:pointer}
  .goods_attr li.b{border:1px dotted #CCC;color:#DDD; pointer:none;}
  .goods_attr li.b img {opacity:0.4;}
  .goods_attr li.sel{ border:1px solid #c80a28;color:#333;}

  .goods_attr li.text{margin:5px 10px 5px 0; height:23px;line-height:23px;text-indent:0;padding:0 23px;font-style:normal;}
  .goods_attr li.img{ margin-right:10px;width:35px;height:35px; line-height:35px;text-align:center;}
      
    */  
      </style>
      
  <div id="panel">
      <div id="panel_sku_list"><pre></pre></div>
      <div id="panel_sel">
      
      </div>

  </div>      
      
  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.min.js"></script>    
  <script type="text/javascript">
  /*
  属性集
  下面一共有4个属性
  属性item1 下面有 2个属性值 分别是 10,11
  （举个常见的例子 属性尺码 下有 S M L XL 4个属性值 ）
  */
  // var keys = {
  //     'attr1':['10','11'],
  //     'attr2':['20','21','22','23'],
  //     'attr3':['30','31','32'],
  //     'attr4':['40','41']
  //     };
  var keys = <?php echo $EndAttrResList ?>;
  //SKU，Stock Keeping Uint(库存量单位)    
  // var sku_list=[
  //         {'attrs':'10|20|30|40','num':120},
  //         {'attrs':'10|21|30|40','num':10},
  //         {'attrs':'10|22|30|40','num':28},
  //         {'attrs':'10|22|31|41','num':220},
  //         {'attrs':'10|22|32|40','num':130},
  //         {'attrs':'11|23|32|41','num':120},
  //         ];  
  var sku_list = <?php echo $SkuResJson ?>;  
  /**init start */
  var defaultsku = <?php echo $defaultSku ?>;

  //显示html结构
  function show_attr_item(){        
      var html='';
      for(k in keys){
          html+='<div class="goods_attr" > <span class="label">'+k+'</span>';
              html+='<ul>'
              for(k2 in keys[k]){
                  _attr_id=keys[k][k2];
                  html+='<li class="text" val="'+k2+'" >';
                  html+='<span>'+k2+'</span>';
                  html+='<s></s>';
                  html+='</li>'
              }
              html+='</ul>';
          html+='</div>';
      }
      $('#panel_sel').html(html);
  }

  //显示数据
  function show_data(sku_list){
      var str="";
      for( k in sku_list){
          str+=sku_list[k]['attr_combine']+"\t"+sku_list[k]['good_stock']+"\t"+sku_list[k]['good_price']+"\t"+sku_list[k]['good_imgs']+"\n";
      }
      // alert(str);good_imgs
      $('#panel_sku_list pre').html(str);
  }


  /******************000000000000000000000000000000000000000000000*/ 
  //自定义的显示
  function self_show_item(){
    var html = '';
    for(k in keys){
      html+='<dl class="property-sale goods_attr"> <dt class="vm-metatit">'+k+'</dt>';
      html+=' <dd>';
      html+='   <ul data-property='+k+' class="clearfix">';
        var isexit = 0; //判断是不是默认的sku
        for(k2 in keys[k]){
          for(skukey in defaultsku){
              if(k2 == defaultsku[skukey]){
                isexit = 1;
                break;
              }else{
                isexit = 0;
              }
          }
          if(isexit){
            html+='<li data-value="14:18238" val="'+k2+'" title='+k2+' class="publicuse selected"><a data-mtype="store_de_sp_1_1" href="javascript:void(0)"> <span>'+k2+'</span></a></li>';
          }else{
            html+='<li data-value="14:18238" val="'+k2+'" title='+k2+' class="publicuse"><a data-mtype="store_de_sp_1_1" href="javascript:void(0)"> <span>'+k2+'</span></a></li>';
          }
        }
      html+='   <ul>';
      html+=' </dd>';
      html+='</dl>';
    }
    $('#selfadd').html(html);
  }

  show_data(sku_list);
  show_attr_item();
  self_show_item();

  /**init end */

  //获取所有包含指定节点的路线
  function filterProduct(ids){
      var res=[];
      $(sku_list).each(function(k,v){
          _attr=','+v['attr_combine']+',';
          _all_ids_in=true;
          for( k in ids){
              if(_attr.indexOf(','+ids[k]+',')==-1){
                  _all_ids_in=false;
                  break;
              }
          }
          if(_all_ids_in){
              res.push(v);    
          }
      
      });
      return res;
  }
      
  //获取 经过已选节点 所有线路上的全部节点
  // 根据已经选择得属性值，得到余下还能选择的属性值
  function filterAttrs(ids){
      var products=filterProduct(ids);
      //console.log(products);
      var res=[];
      $(products).each(function(k,v){
          res=res.concat(v['attr_combine'].split(','));
      });
      return res;
  }


  //已选择的节点数组
  function _getSelAttrId(){
       var list=[];
       $('.goods_attr li.selected').each(function(){
          list.push($(this).attr('val'));
       });
       return list;
  }

  $('.goods_attr li').click(function(){
      if($(this).hasClass('disabled')){
          return ;//被锁定了
      }
      if($(this).hasClass('selected')){
          $(this).removeClass('selected');
      }else{
          $(this).siblings().removeClass('selected');
          $(this).addClass('selected');
      }
      var select_ids=_getSelAttrId();
      // console.log(select_ids);
      sku = '';
      //得到现有的sku组合 完成去和全局变量sku_list匹配
      for(k in select_ids){
        if(select_ids.length - 1 == k){
          sku += select_ids[k];
        }else{
          sku += select_ids[k] + ',';
        }
      }
      // console.log(sku);
      //判断是否完成的sku
      for(key in sku_list){
        if(sku == sku_list[key].attr_combine){
          // console.log(sku_list[key]);
          $('#J_price').html(sku_list[key].good_price);

          //拆图片
          var imgsrc = sku_list[key].good_imgs;
          var imgArr = imgsrc.split(/[,]/);
          var imgstr = '';
          var firstImg = '';
          for( imgkey in imgArr){
            if(imgkey == 0){
              imgstr += '<li class="current">';
              $('#bigimages').attr('src', '__ROOT__'+imgArr[imgkey]+'');
            }else{
              imgstr += '<li class="">';
            }
            imgstr += '<a data-mtype="store_de_tp_11" href="javascript:void(0)">'
            imgstr += '<img src="__ROOT__'+imgArr[imgkey]+'" width="110" height="110" />'
            imgstr += '</a>';
            imgstr +=  '</li>';
             
          }
          $('#J_previewThumb').html(imgstr);
        }
      }
      //已经选择了的规格
      var $_sel_goods_attr=$('li.selected').parents('.goods_attr');
      
      // step 1
      var all_ids=filterAttrs(select_ids);     
      
      //获取未选择的
      var $other_notsel_attr=$('.goods_attr').not($_sel_goods_attr);
      
      //设置为选择属性中的不可选节点
      $other_notsel_attr.each(function(){
         set_block($(this),all_ids);
      
      });
      
      //step 2
      //设置已选节点的同级节点是否可选
      $_sel_goods_attr.each(function(){ 
          update_2($(this));  
      });
      
  });

  function update_2($goods_attr){
      // 若该属性值 $li 是未选中状态的话，设置同级的其他属性是否可选
      var select_ids=_getSelAttrId();
      var $li=$goods_attr.find('li.selected');
      
      var select_ids2=del_array_val(select_ids,$li.attr('val'));
      
      var all_ids=filterAttrs(select_ids2);
      
      set_block($goods_attr,all_ids);
  }

  function set_block($goods_attr,all_ids){

  //根据 $goods_attr下的所有节点是否在可选节点中（all_ids） 来设置可选状态
      $goods_attr.find('li').each(function(k2,li2){
              
          if($.inArray($(li2).attr('val'),all_ids)==-1){
              $(li2).addClass('disabled');
          }else{
              $(li2).removeClass('disabled');
          }
          
      });

  }
  function del_array_val(arr,val){
  //去除 数组 arr中的 val ，返回一个新数组
      var a=[];
      for(k in arr){
          if(arr[k]!=val){
              a.push(arr[k]);
          }
      }
      return a;
  }
          
  </script>